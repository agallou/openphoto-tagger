{% extends 'base.twig' %}

{% block javascript %}
    <script src="https://browserid.org/include.js" type="text/javascript"></script>  
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>

    <script>
    function gotAssertion(assertion) {  
      // got an assertion, now send it up to the server for verification  
      if (assertion !== null) {  
        $.ajax({  
          type: 'POST',  
          url: '/index.php/api/login',  
          data: { assertion: assertion },  
          success: function(res, status, xhr) {
            if (res === null) {
    
              } else {
                window.location.reload(true); 
              }
            //loggedOut();  
              //else loggedIn(res);  
            },  
          error: function(res, status, xhr) {  
            alert("login failure" + res);  
          }  
        });  
      } else {  
        //loggedOut();  
      }  
    }
    </script>
    
    <script>
    $(document).ready(function() {
      $('#browserid').click(function() {  
        navigator.id.get(gotAssertion);  
        return false;  
      });  
    });  
    
    </script>
{% endblock %}


{% block body %}  
    <div class="well login">
      <h6>Openphoto tagger</h6>

      <a id="browserid" title="Sign-in with BrowserID"><img src="https://browserid.org/i/sign_in_blue.png" alt="Sign in"></a>  
    </div>

{% endblock %} 
